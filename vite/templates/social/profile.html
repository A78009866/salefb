{% extends 'social/base.html' %}
{% load static %}
{% block content %}
<div class="row">
    <div class="col-md-8 mx-auto">
        <!-- رأس الملف الشخصي -->
        <div class="card mb-4">
            <div class="card-body text-center">
                
                {% if profile_user.profile_picture %}
                    <img src="{{ profile_user.profile_picture.url }}" class="profile-pic mb-3" style="width: 100px; height: 100px;" alt="{{ profile_user.username }}">
                {% else %}
                    <img src="/media/profile_pics/default_profile.png" class="profile-pic mb-3" style="width: 100px; height: 100px;" alt="الصورة الافتراضية">
                {% endif %}
                <h3>{{ profile_user.full_name }}</h3>
                <p class="text-muted">@{{ profile_user.username }}</p>
                {% if profile_user == request.user %}
<div class="d-flex justify-content-center gap-2 mt-3">
    <a href="{% url 'edit_profile' request.user.username %}" class="btn btn-outline-primary">تعديل الملف الشخصي</a>
    <a href="{% url 'create_post' %}" class="btn btn-primary">إنشاء منشور جديد</a>
</div>
{% endif %}
                {% if profile_user != request.user %}
                <div class="d-flex justify-content-center gap-2">
                    {% if is_friend %}
                        <button class="btn btn-outline-secondary" disabled>أصدقاء</button>
                        <!-- في ملف profile.html -->
{% if is_friend %}
    <a href="{% url 'new_chat' profile_user.username %}" class="btn btn-primary">
        <i class="fas fa-comment"></i> راسل
    </a>
{% endif %}

                    {% elif has_sent_request %}
                        <button class="btn btn-outline-secondary" disabled>تم إرسال الطلب</button>
                    {% elif has_received_request %}
                        <a href="{% url 'accept_friend_request' profile_user.username %}" class="btn btn-primary me-2">قبول الطلب</a>
                        <a href="{% url 'reject_friend_request' profile_user.username %}" class="btn btn-outline-danger">رفض</a>
                    {% else %}
                        <a href="{% url 'send_friend_request' profile_user.username %}" class="btn btn-primary">إضافة صديق</a>
                    {% endif %}

                    {% if profile_user in request.user.blocked_users.all %}
                        <a href="{% url 'unblock_user' profile_user.username %}" class="btn btn-outline-warning">إلغاء الحظر</a>
                    {% else %}
                        <a href="{% url 'block_user' profile_user.username %}" class="btn btn-outline-danger">حظر</a>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>

        <!-- منشورات المستخدم -->
          {% for post in posts %}
                {% include 'social/post_template.html' with post=post %}
            {% endfor %}
{% endblock %}